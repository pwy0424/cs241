<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>MP7 MapReduce: libds/libds.c File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">MP7 MapReduce
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('libds_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">libds/libds.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;search.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;pthread.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="libds_8h_source.html">libds.h</a>&quot;</code><br/>
</div><table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdatastore__entry__t.html">datastore_entry_t</a></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libds_8c.html#ad446573df8913030d3080d2fbba34596">datastore_init</a> (<a class="el" href="structdatastore__t.html">datastore_t</a> *ds)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the data store.  <a href="#ad446573df8913030d3080d2fbba34596"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libds_8c.html#a6a4e7d8edc297d72ea74146da93fb242">datastore_put</a> (<a class="el" href="structdatastore__t.html">datastore_t</a> *ds, const char *key, const char *value)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds the key-value pair (key, value) to the data store, if and only if the key does not already exist in the data store.  <a href="#a6a4e7d8edc297d72ea74146da93fb242"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libds_8c.html#ab12f8afa05e553c287c84f5f5acd7d35">datastore_get</a> (<a class="el" href="structdatastore__t.html">datastore_t</a> *ds, const char *key, unsigned long *revision)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the current value, and its revision number, for a specific key.  <a href="#ab12f8afa05e553c287c84f5f5acd7d35"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libds_8c.html#ace94c3e88e3e4961ab81dc42796e6d6d">datastore_update</a> (<a class="el" href="structdatastore__t.html">datastore_t</a> *ds, const char *key, const char *value, unsigned long known_revision)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the specific key in the data store if and only if the key exists in the data store and the key's revision in the data store matches the knwon_revision specified.  <a href="#ace94c3e88e3e4961ab81dc42796e6d6d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libds_8c.html#a0e80b7044f9a740cfab92a9085eb6d3e">datastore_delete</a> (<a class="el" href="structdatastore__t.html">datastore_t</a> *ds, const char *key, unsigned long known_revision)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes a specific key from the data store.  <a href="#a0e80b7044f9a740cfab92a9085eb6d3e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libds_8c.html#a4cd71ba07efd086dcfccdfa3335f1212">datastore_destroy</a> (<a class="el" href="structdatastore__t.html">datastore_t</a> *ds)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys the data store, freeing any memory that is in use by the data store.  <a href="#a4cd71ba07efd086dcfccdfa3335f1212"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"></div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="a0e80b7044f9a740cfab92a9085eb6d3e"></a><!-- doxytag: member="libds.c::datastore_delete" ref="a0e80b7044f9a740cfab92a9085eb6d3e" args="(datastore_t *ds, const char *key, unsigned long known_revision)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long <a class="el" href="libds_8h.html#a0e80b7044f9a740cfab92a9085eb6d3e">datastore_delete</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdatastore__t.html">datastore_t</a> *&#160;</td>
          <td class="paramname"><em>ds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>known_revision</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deletes a specific key from the data store. </p>
<p>This function is thread-safe.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ds</td><td>An initialized data store. </td></tr>
    <tr><td class="paramname">key</td><td>The specific key to update in the data store. </td></tr>
    <tr><td class="paramname">known_revision</td><td>The revision number for the key specified that is expected to be found in the data store. If the revision number specified in calling the function does not match the revision number in the data store, this function will not update the data store.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>The revision number specified did not match the revision number in the data store or the key was not found in the data store. If the key is in the data store, this indicates that the data has been modified since you last performed a <a class="el" href="libds_8c.html#ab12f8afa05e553c287c84f5f5acd7d35" title="Retrieves the current value, and its revision number, for a specific key.">datastore_get()</a> operation. You should get an updated value from the data store. </td></tr>
    <tr><td class="paramname">non-zero</td><td>The key was deleted from the data store. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a4cd71ba07efd086dcfccdfa3335f1212"></a><!-- doxytag: member="libds.c::datastore_destroy" ref="a4cd71ba07efd086dcfccdfa3335f1212" args="(datastore_t *ds)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="libds_8h.html#a4cd71ba07efd086dcfccdfa3335f1212">datastore_destroy</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdatastore__t.html">datastore_t</a> *&#160;</td>
          <td class="paramname"><em>ds</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Destroys the data store, freeing any memory that is in use by the data store. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ds</td><td>An initialized data store. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab12f8afa05e553c287c84f5f5acd7d35"></a><!-- doxytag: member="libds.c::datastore_get" ref="ab12f8afa05e553c287c84f5f5acd7d35" args="(datastore_t *ds, const char *key, unsigned long *revision)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="libds_8h.html#ab12f8afa05e553c287c84f5f5acd7d35">datastore_get</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdatastore__t.html">datastore_t</a> *&#160;</td>
          <td class="paramname"><em>ds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>revision</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Retrieves the current value, and its revision number, for a specific key. </p>
<p>This function is thread-safe.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ds</td><td>An initialized data store. </td></tr>
    <tr><td class="paramname">key</td><td>The specific key to retrieve the value. </td></tr>
    <tr><td class="paramname">revision</td><td>If non-NULL, the revision number of the returned value will be written to the address pointed to by <code>revision</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>If the data store contains the key, a new string containing the value will be returned. It is the responsibility of the user of the data store to free the value returned. If the data store does not contain the key, NULL will be returned and <code>revision</code> will be unmodified. </dd></dl>

</div>
</div>
<a class="anchor" id="ad446573df8913030d3080d2fbba34596"></a><!-- doxytag: member="libds.c::datastore_init" ref="ad446573df8913030d3080d2fbba34596" args="(datastore_t *ds)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="libds_8h.html#ad446573df8913030d3080d2fbba34596">datastore_init</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdatastore__t.html">datastore_t</a> *&#160;</td>
          <td class="paramname"><em>ds</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initializes the data store. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ds</td><td>An uninitialized data store. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a6a4e7d8edc297d72ea74146da93fb242"></a><!-- doxytag: member="libds.c::datastore_put" ref="a6a4e7d8edc297d72ea74146da93fb242" args="(datastore_t *ds, const char *key, const char *value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long <a class="el" href="libds_8h.html#a6a4e7d8edc297d72ea74146da93fb242">datastore_put</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdatastore__t.html">datastore_t</a> *&#160;</td>
          <td class="paramname"><em>ds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds the key-value pair (key, value) to the data store, if and only if the key does not already exist in the data store. </p>
<p>The data store will make an internal copy key and value, if necessary, so the user of the data store may free these strings if necessary.</p>
<p>This function is thread-safe.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ds</td><td>An initialized data store. </td></tr>
    <tr><td class="paramname">key</td><td>The key to be added to the data store. </td></tr>
    <tr><td class="paramname">value</td><td>The value to associated with the new key.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>The key already exists in the data store. </td></tr>
    <tr><td class="paramname">non-zero</td><td>The revision number assigned to the specific value for the given key. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ace94c3e88e3e4961ab81dc42796e6d6d"></a><!-- doxytag: member="libds.c::datastore_update" ref="ace94c3e88e3e4961ab81dc42796e6d6d" args="(datastore_t *ds, const char *key, const char *value, unsigned long known_revision)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long <a class="el" href="libds_8h.html#ace94c3e88e3e4961ab81dc42796e6d6d">datastore_update</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdatastore__t.html">datastore_t</a> *&#160;</td>
          <td class="paramname"><em>ds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>known_revision</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Updates the specific key in the data store if and only if the key exists in the data store and the key's revision in the data store matches the knwon_revision specified. </p>
<p>The data store will make an internal copy key and value, if necessary, so the user of the data store may free these strings if necessary.</p>
<p>This function is thread-safe.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ds</td><td>An initialized data store. </td></tr>
    <tr><td class="paramname">key</td><td>The specific key to update in the data store. </td></tr>
    <tr><td class="paramname">value</td><td>The updated value to the key in the data store. </td></tr>
    <tr><td class="paramname">known_revision</td><td>The revision number for the key specified that is expected to be found in the data store. If the revision number specified in calling the function does not match the revision number in the data store, this function will not update the data store.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>The revision number specified did not match the revision number in the data store or the key was not found in the data store. If the key is in the data store, this indicates that the data has been modified since you last performed a <a class="el" href="libds_8c.html#ab12f8afa05e553c287c84f5f5acd7d35" title="Retrieves the current value, and its revision number, for a specific key.">datastore_get()</a> operation. You should get an updated value from the data store. </td></tr>
    <tr><td class="paramname">non-zero</td><td>The new revision number for the key, now associated with the new value. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="libds_8c.html">libds.c</a>      </li>

    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
